# 13. 교착상태

## 식사하는 철학자 문제
<br/>

> **교착상태**
>
> 일어나지 않을 사건을 기다리며 진행이 멈춰 버리는 현상

<br/>

![](https://github.com/sohyeonBak/sohyeonBak/assets/76677897/70f0f98b-7e04-4c31-8dfd-3e02261add28)


**교착상태 현상 1**
![](https://github.com/sohyeonBak/sohyeonBak/assets/76677897/0e43e4a2-1e61-4678-8ac9-83024471d96b)

**교착상태 현상 2(뮤텍스 락)**
![](https://github.com/sohyeonBak/sohyeonBak/assets/76677897/c6ac5b72-4373-4704-87e7-eede07b8846a)

<br/>

## 자원 할당 그래프
: 어떤 프로세스가 어떤 자원을 사용하고 있고, 어떤 자원을 기다리고 있는지 표현한 그래프

<br/>

### 자원 할당 그래프 규칙
1. 프로세스는 원, 자원은 사각형으로 표현
2. 사용 가능한 자원의 개수는 사각형 안의 점으로 표현
3. 프로세스가 어떤 자원을 할당받아 사용 중이라면 자원에서 프로세스를 향해 화살표 표시
   - 프로세스가 자원 이용을 끝내고 운영체제에 반납하면 화살표는 사라진다. 
4. 프로세스가 어떤 자원을 기다리고 있다면 프로세스에서 자원으로 화살표 표시

![](https://github.com/sohyeonBak/sohyeonBak/assets/76677897/d0a876c4-b8cb-49f3-ade7-ca8b118e4102)

<br/>

## 교착 상태 발생 조건
>상호배제, 점유와 대기, 비선점, 원형 대기 조건 중 하나라도 만족하지 않는다면 교착상태가 발생하지 않지만 모두 만족한다면 교착상태가 발생할 수 있다.

<br/>

### 상호배제
: 한 프로세스가 사용중인 자원을 다른 프로세스가 사용할 수 없는 상황
<br/>

### 점유와 대기
: 프로세스가 한 자원을 할당한 채 다른 자원을 할당받기를 대기하는 상태
<br/>

### 비선점
: 비선점 자원은 사용중인 프로세스가 해당 자원 사용을 완료해야 다른 프로세스에서 사용할 수 있다.
<br/>

### 원형 대기
: 프로세스들이 프로세스가 할당받은 자원이 원의 형태를 띄우는 현상, 자원 할당 그래프가 원의 형태

<br/>

## 교착 상태 해결 방법

### 교착 상태 예방
: 교착 상태 발생 조건 중 하나를 충족시키지 못하게 만드는 방법

* 상호배제: 모든 자원을 공유 가능하게 만드는 방법 (현실적인 문제 발생 ↓)
![](https://github.com/sohyeonBak/sohyeonBak/assets/76677897/57f9e6df-affc-43a7-84d0-c4045c6fdf75)
* 점유와 대기: 한 프로세스에 모든 자원을 할당하거나 하지못하는 방식
  * 자원이 당장 필요하지 않아도 자원을 할당하거나 자원이 당장 필요하지만 대기해야하는 현상이 발생
  * 자원이 많이 필요한 프로세스는 자원 할당 받는 타이밍이 늦어질 가능성 높음
* 비선점: 자원을 사용중인 프로세스의 자원을 뺏어오는 방법
  * CPU: 일정 시간이 지나면 작업이 완료되지 않아도 다른 프로세스가 CPU를 할당할 수 있다.
  * 모든 자원이 선점할 수 있는 것은 아님(프린터 자원)
* 원형대기: 모든 자원에 번호를 붙여 자원이 원형이 아닌 선형으로 할당하는 방법
  * 컴퓨터 모든 시스템에 번호를 매겨야 하는 복잡함
  * 번호에 따라 특정 자원의 활용률이 낮아질 수 있음

<br/>

### 교착 상태 회피
: 교착 상태가 발생하지 않을 정도로만 자원을 할당하는 방식, 교착 상태 회피에서는 교착 상태를 한정된 자원의 무분별한 할당으로 발생하는 문제로 여긴다.

**안전 순서열**
: 교착 상태 없이 안전하게 프로세스에 자원을 할당할 수 있는 순서

**안전 상태**
: 안전 순서열을 따라 교착 상태가 되지 않고 자원을 프로세스에 할당할 수 있는 상태
![](https://github.com/sohyeonBak/sohyeonBak/assets/76677897/98e2050b-630c-4d95-828e-ca3820f3d17c)

**불안전 상태**
: 안전 순서열이 없어서 교착 상태에 빠질 수 있는 상태
![](https://github.com/sohyeonBak/sohyeonBak/assets/76677897/25d0d62e-3257-43c0-bb81-3864276638f8)

<br/>

> 프로세스 자원할당 순서
> 1. 프로세스와 스레드가 운영체제에 자원을 요청
> 2. 운영체제로부터 자원을 할당 받아 사용
> 3. 사용이 완료된 자원을 운영체제에 반환

<br/>

## 교착 상태 검출 후 회복
: 교착 상태 발생을 인정하고 사후에 조치하는 방법

* 운영체제는 프로세스에서 자원을 요구할 때마다 모두 할당
* 교착 상태 발생 여부를 주기적으로 검사

### 선점을 통한 회복
: 교착 상태가 해결될 때까지 한 프로세스씩 자원을 모아주는 방식

### 프로세스 강제 종료를 통한 회복
* 교착 상태에 놓인 프로세스를 한꺼번에 종료
  * 사용중이던 작업 내역을 잃을 가능성 높음
* 교착 상태가 해결 될 때까지 하나의 프로세스를 차례대로 종료
  * 교착 상태를 확인하는 과정에서 오버헤드를 만날 수 있음

### 타조 알고리즘
: 드물게 발생하는 잠재적인 문제를 무시로 대체하는 방법, 효율을 위해 사용될 수 있음


